<!-- HEADER ROW DEFINITION TEMPLATES -->
<cdk-header-row *cdkHeaderRowDef="_store.tableIds"
                class="sg-table-header-row"
                [ngStyle]="_mainHeaderRowStyle"></cdk-header-row> <!-- TABLE HEADER ROW DEF, MUST BE LAST -->
<ng-container *ngFor="let headers of _store.headerIds">   <!-- MULTI-HEADER ROW DEF -->
  <cdk-header-row *cdkHeaderRowDef="headers.keys" class="sg-table-header-row" [class.sg-header-group-row]="headers.type === 'headerGroup'"></cdk-header-row>
</ng-container>
<!-- HEADER ROW DEFINITION TEMPLATES -->

<!-- FOOTER ROW DEFINITION TEMPLATES -->
<cdk-footer-row *cdkFooterRowDef="_store.tableIds" class="sg-table-footer-row"></cdk-footer-row> <!-- TABLE FOOTER ROW DEF -->
<ng-container *ngFor="let footers of _store.footerIds">   <!-- MULTI-FOOTER ROW DEF -->
  <cdk-footer-row *cdkFooterRowDef="footers" class="sg-table-footer-row"></cdk-footer-row>
</ng-container>
<!-- FOOTER ROW DEFINITION TEMPLATES -->

<div class="sg-table-container" [class.no-data]="!dataSource || dataSource.renderLength === 0">
  <div class="sg-table-scroll-container">
    <sg-cdk-table [trackBy]="trackBy">
      <!-- Row templates. The columns used are set at the row template level -->

      <!-- MULTI-HEADER/FOOTER CELL DEF -->
      <ng-container *ngFor="let meta of _store.meta">
        <ng-container *ngIf="(meta.header || meta.headerGroup) as c" [sgTableColumnDef]="c">
          <sg-table-header-cell *cdkHeaderCellDef>
            <ng-container *ngTemplateOutlet="c.template; context: { col: c, table: self }"></ng-container>
          </sg-table-header-cell>
        </ng-container>
        <ng-container *ngIf="meta.footer as c" [sgTableColumnDef]="c">
            <sg-table-footer-cell *cdkFooterCellDef>
              <ng-container *ngTemplateOutlet="c.template; context: { col: c, table: self  }"></ng-container>
            </sg-table-footer-cell>
          </ng-container>
      </ng-container>
      <!-- MULTI-HEADER/FOOTER CELL DEF -->

       <!-- HEADER-RECORD-FOOTER CELL DEF -->
      <ng-container *ngFor="let c of _store.table" [sgTableColumnDef]="c">
        <!-- TABLE HEADER CELL DEF -->
        <sg-table-header-cell *cdkHeaderCellDef
                              [observeSize]="c"></sg-table-header-cell>

        <!-- RECORD CELL DEF -->
        <sg-table-cell *cdkCellDef="let row"
                       [attr.tabindex]="cellFocus">
          <ng-container *ngTemplateOutlet="c.cellTpl; context: (row | tableCellContext: c)"></ng-container>
        </sg-table-cell>

        <!-- TABLE FOOTER CELL DEF -->
        <sg-table-footer-cell *cdkFooterCellDef>
          <ng-container *ngTemplateOutlet="c.footerCellTpl; context: { col: c }"></ng-container>
        </sg-table-footer-cell>
      </ng-container>
      <!-- HEADER-RECORD-FOOTER CELL DEF -->

      <!-- TABLE RECORD ROW DEFINITION TEMPLATES -->
      <sg-table-row *cdkRowDef="let row; columns: _store.tableIds;"></sg-table-row>
      <!-- TABLE RECORD ROW DEFINITION TEMPLATES -->
    </sg-cdk-table>
  </div>

  <ng-container #beforeContent></ng-container>
  <ng-content></ng-content>
  <ng-container #afterContent></ng-container>

</div>

<ng-template #fbTableCell let-value="value">{{value}}</ng-template>
<ng-template #fbHeaderCell let-column="col">{{column.label}}</ng-template>
<ng-template #fbFooterCell let-column="col">{{column.label}}</ng-template>
